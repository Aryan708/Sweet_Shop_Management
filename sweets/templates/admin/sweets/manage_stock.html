{% extends "admin/base_site.html" %}
{% load i18n admin_urls static admin_list %}

{% block title %}{{ title }} | {{ site_title|default:_('Django site admin') }}{% endblock %}

{% block breadcrumbs %}
<div class="breadcrumbs">
    <a href="{% url 'admin:index' %}">{% trans 'Home' %}</a>
    &rsaquo; <a href="{% url 'admin:app_list' app_label='sweets' %}">Sweets</a>
    &rsaquo; {{ title }}
</div>
{% endblock %}

{% block content %}
<div class="module">
    <h1>{{ title }}</h1>
    <p style="margin-bottom: 20px; padding: 10px; background-color: #e3f2fd; border-left: 4px solid #2196f3;">
        <strong>Admin Portal:</strong> Manage which items are available for customers to purchase. 
        Only items with <strong>is_available=True</strong> will be visible to customers in the shop.
    </p>
    
    <!-- Statistics Summary -->
    <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 15px; margin-bottom: 30px;">
        <div style="padding: 15px; background-color: #f5f5f5; border-radius: 5px; text-align: center;">
            <div style="font-size: 32px; font-weight: bold; color: #333;">{{ total_count }}</div>
            <div style="color: #666; margin-top: 5px;">Total Items</div>
        </div>
        <div style="padding: 15px; background-color: #e8f5e9; border-radius: 5px; text-align: center;">
            <div style="font-size: 32px; font-weight: bold; color: #2e7d32;">{{ available_count }}</div>
            <div style="color: #666; margin-top: 5px;">Available for Customers</div>
        </div>
        <div style="padding: 15px; background-color: #fff3e0; border-radius: 5px; text-align: center;">
            <div style="font-size: 32px; font-weight: bold; color: #e65100;">{{ unavailable_count }}</div>
            <div style="color: #666; margin-top: 5px;">Not Available</div>
        </div>
    </div>
    
    <!-- Available Items Section -->
    <div style="margin-bottom: 30px;">
        <h2 style="color: #2e7d32; border-bottom: 2px solid #2e7d32; padding-bottom: 10px;">
            ‚úÖ Available Items (Visible to Customers)
        </h2>
        {% if available_sweets %}
        <div class="results">
            <table id="result_list" style="width:100%">
                <thead>
                    <tr>
                        <th scope="col">Name</th>
                        <th scope="col">Category</th>
                        <th scope="col">Price</th>
                        <th scope="col">Quantity</th>
                        <th scope="col">Stock Level</th>
                        <th scope="col">Actions</th>
                    </tr>
                </thead>
                <tbody>
                    {% for sweet in available_sweets %}
                    <tr class="{% cycle 'row1' 'row2' %}">
                        <th class="field-name">
                            <a href="{% url 'admin:sweets_sweet_change' sweet.pk %}">{{ sweet.name }}</a>
                        </th>
                        <td class="field-category">{{ sweet.get_category_display }}</td>
                        <td class="field-price">${{ sweet.price }}</td>
                        <td class="field-quantity">{{ sweet.quantity }}</td>
                        <td class="field-stock_level">{{ sweet.stock_level }}</td>
                        <td>
                            <a href="{% url 'admin:sweets_sweet_change' sweet.pk %}" class="button">Edit</a>
                        </td>
                    </tr>
                    {% endfor %}
                </tbody>
            </table>
        </div>
        {% else %}
        <p style="padding: 20px; background-color: #fff3e0; border-left: 4px solid #ff9800;">
            No items are currently available for customers. Add items to stock below.
        </p>
        {% endif %}
    </div>
    
    <!-- Unavailable Items Section -->
    <div style="margin-bottom: 30px;">
        <h2 style="color: #e65100; border-bottom: 2px solid #e65100; padding-bottom: 10px;">
            ‚ùå Unavailable Items (Hidden from Customers)
        </h2>
        {% if unavailable_sweets %}
        <div class="results">
            <table id="result_list" style="width:100%">
                <thead>
                    <tr>
                        <th scope="col">Name</th>
                        <th scope="col">Category</th>
                        <th scope="col">Price</th>
                        <th scope="col">Quantity</th>
                        <th scope="col">Stock Level</th>
                        <th scope="col">Actions</th>
                    </tr>
                </thead>
                <tbody>
                    {% for sweet in unavailable_sweets %}
                    <tr class="{% cycle 'row1' 'row2' %}">
                        <th class="field-name">
                            <a href="{% url 'admin:sweets_sweet_change' sweet.pk %}">{{ sweet.name }}</a>
                        </th>
                        <td class="field-category">{{ sweet.get_category_display }}</td>
                        <td class="field-price">${{ sweet.price }}</td>
                        <td class="field-quantity">{{ sweet.quantity }}</td>
                        <td class="field-stock_level">{{ sweet.stock_level }}</td>
                        <td>
                            <a href="{% url 'admin:sweets_sweet_change' sweet.pk %}" class="button">Edit to Make Available</a>
                        </td>
                    </tr>
                    {% endfor %}
                </tbody>
            </table>
        </div>
        {% else %}
        <p style="padding: 20px; background-color: #e8f5e9; border-left: 4px solid #4caf50;">
            All items are currently available for customers.
        </p>
        {% endif %}
    </div>
    
    <!-- Action Buttons -->
    <div class="submit-row" style="margin-top: 30px;">
        <a href="{% url 'admin:sweets_sweet_add' %}" class="button default" style="margin-right: 10px;">
            ‚ûï Add New Item to Stock
        </a>
        <a href="{% url 'admin:sweets_sweet_changelist' %}" class="button" style="margin-right: 10px;">
            üìã View All Items
        </a>
        <a href="{% url 'admin:index' %}" class="button">
            üè† Back to Admin Home
        </a>
    </div>
</div>
{% endblock %}

